<!-- ğŸŒŒ ç§‘æŠ€æ„ŸèƒŒæ™¯ -->
<div class="cyber-bg"></div>

<div class="container-fluid min-vh-100 py-4">
  <header class="text-center mb-5 fade-in-up">
    <div class="cyber-subtitle mb-3">
      âŸ¨ ç”¢å“äºŒéƒ¨ Â· 2025 TEAM BUILDING âŸ©
    </div>
    <h1 class="cyber-title mb-4">
      è®“å°è©±è®Šæˆä¸€é¢é¡å­
    </h1>
    <p class="mx-auto" style="color: var(--text-secondary); max-width: 600px; font-size: 0.95rem; line-height: 1.8;">
      å¾ä¸€å€‹å•é¡Œé–‹å§‹ï¼Œçœ‹è¦‹å½¼æ­¤çš„è¦–è§’ã€å‡è¨­èˆ‡é¸æ“‡<br>
      è®“åœ˜éšŠçš„åˆä½œæ›´æœ‰ç†è§£èˆ‡ä¿¡ä»»
    </p>
  </header>

  <div class="container" style="max-width: 800px;">
    
    <!-- ğŸ® è¼¸å…¥å€å¡Š -->
    <section class="mb-5 fade-in-up" style="animation-delay: 0.1s" *ngIf="!showQuestion">
      <div class="glass-card p-4 p-md-5">
        <!-- å€å¡Šæ¨™é¡Œ -->
        <div class="section-header">
          <span class="section-title">// é–‹å§‹å°è©±</span>
          <div class="section-line"></div>
        </div>

        <!-- è¼¸å…¥æ¡† -->
        <div class="mb-4">
          <input
            id="userName"
            type="text"
            [(ngModel)]="inputName"
            placeholder="è¼¸å…¥ä½ çš„è‹±æ–‡åå­—"
            class="input-neon"
            [class.is-invalid]="inputName.trim() && !isNameValid()"
            [disabled]="countdown > 0"
          />
        </div>

        <!-- éŒ¯èª¤æç¤º -->
        <div class="error-message mb-4" *ngIf="inputName.trim() && !isNameValid()">
          <span class="material-icons me-2" style="font-size: 1.1rem;">error_outline</span>
          é€™å€‹åå­—ä¸åœ¨åƒåŠ åå–®ä¸­å–”
        </div>

        <!-- é–‹å§‹æŒ‰éˆ• -->
        <button
          class="btn-neon w-100 d-flex align-items-center justify-content-center gap-3"
          (click)="drawQuestion()"
          [disabled]="!isNameValid() || isDrawing || countdown > 0"
        >
          <span class="material-icons" style="font-size: 1.8rem;">
            {{ isDrawing ? 'hourglass_top' : 'rocket_launch' }}
          </span>
          <span>
            {{ countdown > 0 ? 'COOLDOWN...' : isDrawing ? 'GENERATING...' : 'LAUNCH DIALOGUE' }}
          </span>
        </button>
      </div>
    </section>

    <!-- ğŸª å•é¡Œå±•ç¤ºå€ -->
    <section class="mb-5 fade-in-up" *ngIf="showQuestion">
      <div class="question-card glass-card">
        <div class="question-name">
          â—ˆ {{ drawnName }}'s QUESTION â—ˆ
        </div>
        <p class="question-text position-relative" style="z-index: 1;">
          {{ animatedQuestion || drawnQuestion }}
        </p>
        <div class="countdown-badge" *ngIf="countdown > 0">
          <span class="material-icons" style="font-size: 1rem;">timer</span>
          {{ countdown }}s UNTIL NEXT
        </div>
      </div>

      <!-- å†æŠ½ä¸€æ¬¡æŒ‰éˆ• -->
      <div class="text-center mt-4">
        <button
          class="btn-ghost d-inline-flex align-items-center gap-2"
          (click)="showQuestion = false; inputName = ''"
        >
          <span class="material-icons">replay</span>
          æ›äººå°è©±
        </button>
      </div>
    </section>

    <!-- ğŸ“Š å°è©±ç´€éŒ„å€ -->
    <section class="fade-in-up" style="animation-delay: 0.2s">
      <div class="glass-card p-4">
        <!-- å¯æ”¶åˆæ¨™é¡Œ -->
        <button
          class="btn-ghost w-100 d-flex justify-content-between align-items-center mb-0"
          (click)="showRecordsSection = !showRecordsSection"
          style="border: none; background: transparent; padding: 0;"
        >
          <div class="section-header mb-0" style="flex: 1;">
            <span class="section-title">// å°è©±ç´€éŒ„</span>
            <div class="section-line"></div>
          </div>
          <span class="material-icons text-neon-cyan" style="font-size: 1.5rem;">
            {{ showRecordsSection ? 'keyboard_arrow_up' : 'keyboard_arrow_down' }}
          </span>
        </button>

        <!-- å±•é–‹å…§å®¹ -->
        <div *ngIf="showRecordsSection" class="mt-4">
          <!-- çµ±è¨ˆæ•¸æ“š -->
          <div class="d-flex justify-content-between align-items-center mb-4">
            <div class="stats-bar">
              <div class="stat-item">
                <span class="stat-value">{{ totalQuestionsToday || 0 }}</span>
                <span class="stat-label">TOPICS</span>
              </div>
              <div class="stat-item">
                <span class="stat-value">{{ uniqueSpeakersToday || 0 }}</span>
                <span class="stat-label">SPEAKERS</span>
              </div>
            </div>
            <button 
              class="btn-icon"
              (click)="refreshRecords()"
              [disabled]="isLoadingRecords"
              title="é‡æ–°æ•´ç†"
            >
              <span class="material-icons" [class.spinning]="isLoadingRecords">sync</span>
            </button>
          </div>

          <!-- è¨˜éŒ„åˆ—è¡¨ -->
          <div class="records-list stagger" *ngIf="records.length > 0; else noRecords">
            <div
              class="record-item"
              *ngFor="let record of records.slice().reverse(); let i = index"
            >
              <div class="d-flex justify-content-between align-items-start mb-2">
                <span class="record-name">{{ record.name }}</span>
                <span class="record-time">{{ record.timestamp | date:'HH:mm' }}</span>
              </div>
              <p class="record-question mb-0">{{ record.question }}</p>
            </div>
          </div>

          <!-- ç©ºç‹€æ…‹ -->
          <ng-template #noRecords>
            <div class="empty-state">
              <span class="material-icons empty-icon">emoji_events</span>
              <p class="empty-title">ç¬¬ä¸€å€‹å°è©±ï¼Œå°±äº¤çµ¦ä½ ä¾†é–‹å ´</p>
              <p class="empty-desc">è¼¸å…¥åå­—ï¼ŒæŠ½å‡ºä¸€é¡Œï¼Œèªªèªªä½ çœ‹è¦‹äº†ä»€éº¼</p>
            </div>
          </ng-template>
        </div>
      </div>
    </section>

  </div>
</div>
