
<div class="container-fluid min-vh-100 py-4" style="background: linear-gradient(135deg, #f8fafc 0%, #e0e7ef 100%);">
  <header class="text-center mb-5 fade-in">
    <h1 class="display-5 fw-bold mb-2" style="color: #222; text-shadow: 0 2px 16px rgba(0,0,0,0.04);">
      讓對話變成一面鏡子
    </h1>
    <p class="lead" style="color: #444; font-size: 1rem;">產品二部 · 2025 Team Building</p>
  </header>

  <div class="container" style="max-width: 600px;">
    <div class="input-section mb-5 fade-in" *ngIf="!showQuestion">
      <input
        id="userName"
        type="text"
        [(ngModel)]="inputName"
        placeholder="請輸入你的英文名字"
        class="form-control form-control-lg glass-input mb-3"
        [class.is-invalid]="inputName.trim() && !isNameValid()"
        [disabled]="countdown > 0"
      />
      <div class="invalid-feedback d-block mb-3" *ngIf="inputName.trim() && !isNameValid()" style="color: #b91c1c; background: rgba(255,107,107,0.15); padding: 0.75rem; border-radius: 12px;">
        ⚠️ 這個名字不在參加名單中喔
      </div>

      <button
        class="btn btn-primary btn-lg w-100 d-flex align-items-center justify-content-center gap-2"
        (click)="drawQuestion()"
        [disabled]="!isNameValid() || isDrawing || countdown > 0"
        style="height: 64px; font-size: 1.2rem; background: linear-gradient(90deg,#fbbf24 0%,#60a5fa 100%); color:#222; font-weight:700; border:2px solid #fff; box-shadow:0 2px 12px rgba(34,61,47,0.08);"
      >
        <span class="material-icons" style="font-size: 2rem; color:#2563eb;">question_answer</span>
        {{
          countdown > 0
            ? "請稍候..."
            : isDrawing
            ? "產生題目中..."
            : "開始對話"
        }}
      </button>
    </div>

    <div class="question-display-floating glass-effect text-center p-5 mb-5 fade-in" *ngIf="showQuestion">
      <div class="mb-3" style="color: #2563eb; font-weight: 700; font-size: 1.1rem;">
        {{ drawnName }} 的對話題目
      </div>
      <p class="question-content mb-3" style="font-size: 1.4rem; font-weight: 600; color: #1a1a1a; line-height: 1.6;">
        {{ drawnQuestion }}
      </p>
      <div class="countdown-info" *ngIf="countdown > 0" style="color: #b91c1c; font-size: 0.95rem;">
        ⏱️ {{ countdown }} 秒後可再產生新題目
      </div>
    </div>

    <div class="records-section fade-in">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="mb-0" style="color: #2563eb; font-weight: 700; font-size: 1.15rem;">
          對話記錄
        </h5>
        <div class="d-flex align-items-center gap-2">
          <button 
            class="btn btn-sm"
            (click)="refreshRecords()"
            [disabled]="isLoadingRecords"
            title="重新整理"
            style="background: #e0e7ef; border: none; padding: 0.5rem; border-radius: 12px;"
          >
            <span class="material-icons" [class.spinning]="isLoadingRecords" style="color: #2563eb; font-size: 1.5rem;">sync</span>
          </button>
        </div>
      </div>

      <div class="records-list" *ngIf="records.length > 0; else noRecords">
        <div
          class="record-item glass-effect d-flex gap-3 align-items-start mb-3 p-3"
          *ngFor="let record of records.slice().reverse()"
        >
          <div class="flex-grow-1">
            <div class="d-flex justify-content-between align-items-start mb-1">
              <h6 class="mb-0 fw-bold" style="color: #222;">{{ record.name }}</h6>
              <small style="color: #888; font-size: 0.85rem;">{{ record.timestamp | date : "HH:mm" }}</small>
            </div>
            <p class="mb-0" style="color: #444; font-size: 0.95rem; line-height: 1.5;">{{ record.question }}</p>
          </div>
        </div>
      </div>
      
      <ng-template #noRecords>
        <div class="text-center py-5 glass-effect" style="border-radius: 20px;">
          <span class="material-icons mb-3" style="font-size: 64px; color: #e0e7ef;">emoji_events</span>
          <p class="mb-0" style="color: #2563eb; font-size: 1.1rem;">還沒有人分享，就等你來了！</p>
        </div>
      </ng-template>
    </div>
  </div>
</div>
